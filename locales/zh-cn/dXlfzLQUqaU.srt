1
00:00:00,000 --> 00:00:01,540
我们来探索

2
00:00:01,540 --> 00:00:03,209
控制台的另一个部分

3
00:00:03,209 --> 00:00:05,759
目前为止 你发送的所有消息

4
00:00:05,759 --> 00:00:08,669
都发送到了使用该应用的每一个人

5
00:00:08,669 --> 00:00:11,282
这是因为我们使用了这个“用户组”（user segment）目标 

6
00:00:11,282 --> 00:00:12,990
但是如果我想将通知发送到

7
00:00:12,990 --> 00:00:15,080
一名特定用户呢？

8
00:00:15,080 --> 00:00:17,820
在控制台中 我可以选择“单个设备”（single device）

9
00:00:17,820 --> 00:00:20,260
但现在 它要我提供一个叫作 FCM 注册令牌

10
00:00:20,260 --> 00:00:21,810
的东西

11
00:00:21,809 --> 00:00:24,329
FCM 注册令牌是一个由数字和字符

12
00:00:24,329 --> 00:00:26,189
组成的字符串 用于

13
00:00:26,190 --> 00:00:29,040
唯一地标识设备

14
00:00:29,039 --> 00:00:31,710
它在应用首次启动时生成

15
00:00:31,710 --> 00:00:35,100
并在你卸载和重装应用后更改

16
00:00:35,100 --> 00:00:38,280
FCM 服务器可以使用这些独特的令牌将消息

17
00:00:38,280 --> 00:00:40,480
发送到特定设备

18
00:00:40,478 --> 00:00:42,179
那么来看看你如何找到

19
00:00:42,179 --> 00:00:45,707
自己设备的 FCM 注册令牌

20
00:00:45,707 --> 00:00:47,789
实际上网上有比较清楚的

21
00:00:47,789 --> 00:00:49,500
方法文档

22
00:00:49,500 --> 00:00:51,570
我向下滚动 第一步是

23
00:00:51,570 --> 00:00:55,020
创建一个扩展 FirebaseInstanceIDService

24
00:00:55,020 --> 00:00:56,790
的服务

25
00:00:56,789 --> 00:00:58,710
像所有 Android 组件一样 该服务

26
00:00:58,710 --> 00:01:01,079
需要注册到清单文件

27
00:01:01,079 --> 00:01:03,808
现在 要在为你的设备生成令牌时

28
00:01:03,810 --> 00:01:05,549
捕获事件 你需要

29
00:01:05,549 --> 00:01:07,009
在此添加 intent 过滤器

30
00:01:07,010 --> 00:01:10,950
它具有操作 Instance_ID_Event

31
00:01:10,950 --> 00:01:13,950
在扩展此服务并将它添加到清单文件后

32
00:01:13,950 --> 00:01:16,230
另一件你真正需要做的事

33
00:01:16,230 --> 00:01:19,100
是实现此 onTokenRefresh 方法

34
00:01:19,099 --> 00:01:21,629
而此方法是 FirebaseInstanceIDService 的

35
00:01:21,629 --> 00:01:22,158
一部分

36
00:01:22,159 --> 00:01:24,450
从功能方面来说 在调用此方法时 你可以

37
00:01:24,450 --> 00:01:25,996
执行多个不同的操作

38
00:01:25,995 --> 00:01:28,243
但是对于你 则只需知道这个令牌的内容

39
00:01:28,245 --> 00:01:31,109
以便在日志中将它实际打印出来

40
00:01:31,108 --> 00:01:33,628
对于我的 FirebaseInstanceIDService 类

41
00:01:33,629 --> 00:01:36,959
我创建了一个叫作 FCM 的新文件夹并将它保存在了里面

42
00:01:36,959 --> 00:01:41,489
在这个类中 我有一个 onTokenRefresh 方法

43
00:01:41,489 --> 00:01:43,489
它会将令牌打印出来

44
00:01:43,489 --> 00:01:45,478
还有一个无用的 sendRegistrationToSever 方法 

45
00:01:45,480 --> 00:01:48,450
在此课程中我不会用到它

46
00:01:48,450 --> 00:01:49,810
在此课程中我不会用到它

47
00:01:49,810 --> 00:01:53,070
但你可以阅读注释 了解它的用处

48
00:01:53,069 --> 00:01:55,439
接下来我要运行我的应用

49
00:01:55,438 --> 00:01:57,449
然后在这里的日志中 可以看到

50
00:01:57,450 --> 00:02:00,450
产生了一个实例 ID 令牌

51
00:02:00,450 --> 00:02:03,450
那么我复制此令牌

52
00:02:03,450 --> 00:02:07,219
并将它粘贴在控制台中的这个位置

53
00:02:07,218 --> 00:02:10,710
我要输入一些消息文本 然后

54
00:02:10,710 --> 00:02:13,290
发送消息

55
00:02:13,288 --> 00:02:16,750
可以看到我收到了这条消息

56
00:02:16,750 --> 00:02:18,628
好的 现在你可以自己操作了

57
00:02:18,628 --> 00:02:22,348
使用 FirebaseInstanceIDService

58
00:02:22,348 --> 00:02:24,948
为你的设备生成唯一的令牌

59
00:02:24,949 --> 00:02:26,799
在日志中打印出此令牌

60
00:02:26,800 --> 00:02:30,790
然后使用它向你自己的设备发送 FCM 消息

61
00:02:30,788 --> 00:02:33,238
完成后 作为下一个小测试的一部分

62
00:02:33,240 --> 00:02:35,409
输入此 FCM 注册令牌


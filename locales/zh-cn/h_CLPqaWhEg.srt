1
00:00:00,367 --> 00:00:02,700
要在Fragment与其 HostActivity 之间

2
00:00:02,700 --> 00:00:06,179
进行通信 你可以在 fragment 类中定义一个接口

3
00:00:06,179 --> 00:00:08,458
并在 Activity 中实现

4
00:00:08,460 --> 00:00:10,380
那么我们就通过这种方式 使我们的 MasterListFragment

5
00:00:10,380 --> 00:00:13,230
与 MainActivity 进行通信

6
00:00:13,230 --> 00:00:15,630
要定义一个接口 我们需要在 MasterListFragment

7
00:00:15,630 --> 00:00:18,030
中创建一个侦听器

8
00:00:18,030 --> 00:00:19,350
你可以将它命名为任何东西

9
00:00:19,350 --> 00:00:21,630
我称之为 onImageClickListener

10
00:00:21,629 --> 00:00:24,539
然后给它一个变量名 mCallback

11
00:00:24,539 --> 00:00:26,579
它将最终在 HostActivity 中

12
00:00:26,579 --> 00:00:28,439
实现 然后我们可以在其中对它

13
00:00:28,440 --> 00:00:30,150
编程 以在列表图像被点击时

14
00:00:30,149 --> 00:00:31,899
执行一些操作

15
00:00:31,899 --> 00:00:34,948
然后 要定义此接口 我们只需指定

16
00:00:34,950 --> 00:00:36,500
它触发的方法

17
00:00:36,500 --> 00:00:38,158
这里 我们让它触发叫作

18
00:00:38,158 --> 00:00:40,228
onImageSelected 的方法

19
00:00:40,228 --> 00:00:42,265
它以一个 int 变量 position 作为输入

20
00:00:42,267 --> 00:00:44,850
这将是用户在我们的 GridView 上点击

21
00:00:44,850 --> 00:00:46,300
的位置

22
00:00:46,298 --> 00:00:49,018
我们还需确保 HostActivity 实现了

23
00:00:49,020 --> 00:00:50,070
回调

24
00:00:50,070 --> 00:00:51,600
我们可以在 MasterListFragment 的

25
00:00:51,600 --> 00:00:53,969
onAttach 方法中检查

26
00:00:53,969 --> 00:00:55,859
这是Fragment附加到其 HostActivity

27
00:00:55,859 --> 00:00:57,539
的地方

28
00:00:57,539 --> 00:00:59,518
然后它会检查看 onImageClickListener

29
00:00:59,520 --> 00:01:02,400
是否实现了 如果没有

30
00:01:02,399 --> 00:01:04,140
则抛出一个异常

31
00:01:04,140 --> 00:01:07,200
最后 在 onCreateView 中 我们需要在发生点击时

32
00:01:07,200 --> 00:01:08,769
触发调用

33
00:01:08,769 --> 00:01:11,250
那么我们将在 GridView 上设置一个点击侦听器

34
00:01:11,250 --> 00:01:14,099
每当我们 GridView 中的某个项被点击时

35
00:01:14,099 --> 00:01:16,959
调用回调方法 onImageSelected

36
00:01:16,959 --> 00:01:19,558
然后我们也可以传入点击位置

37
00:01:19,560 --> 00:01:21,870
现在我们已在 fragment 中定义了此接口

38
00:01:21,870 --> 00:01:23,920
我们将其连接到 MainActivity

39
00:01:23,920 --> 00:01:26,159
我前面提到为了从 MasterListFragment

40
00:01:26,159 --> 00:01:28,590
接收回调 MainActivity

41
00:01:28,590 --> 00:01:32,520
必须实现我们在 fragment 类中定义的接口

42
00:01:32,519 --> 00:01:34,868
那么在顶部 我写下 implements Master

43
00:01:34,870 --> 00:01:38,075
Listfragment.onImageClickListener

44
00:01:38,075 --> 00:01:39,450
这时你会看到我们收到一条错误消息

45
00:01:39,450 --> 00:01:41,460
因为我们还需实现

46
00:01:41,459 --> 00:01:44,399
onImageSelected 方法

47
00:01:44,400 --> 00:01:47,550
我们来定义 onImageSelected 的行为 

48
00:01:47,549 --> 00:01:50,219
这是我们处理Fragment通信的地方

49
00:01:50,218 --> 00:01:53,428
这个接口很像一个自定义点击侦听器

50
00:01:53,430 --> 00:01:55,050
它在 fragment 类中触发

51
00:01:55,049 --> 00:01:57,810
并在 HostActivity 中执行一些操作

52
00:01:57,810 --> 00:02:00,030
现在在 onImageSelected 中 我

53
00:02:00,030 --> 00:02:02,099
创建了一个 Toast 消息 看看我们是否

54
00:02:02,099 --> 00:02:03,959
正确实现了此通信

55
00:02:03,959 --> 00:02:06,209
它应在某个图像被点击时显示关于点击位置

56
00:02:06,209 --> 00:02:07,808
的消息

57
00:02:07,810 --> 00:02:09,090
我们来试试看

58
00:02:09,090 --> 00:02:11,008
现在你会看到 每次当我点击 MasterList 中

59
00:02:11,008 --> 00:02:14,250
的一个图片时 一个短的 Toast 消息就会出现

60
00:02:14,250 --> 00:02:18,449
位置的范围在 0 到 35 之间

61
00:02:18,449 --> 00:02:20,639
接下来 轮到你来完成此代码

62
00:02:20,639 --> 00:02:22,199
并成功实现 fragment

63
00:02:22,199 --> 00:02:24,919
与 Activity 通信


1
00:00:00,000 --> 00:00:01,899
Fragment为了帮助你在学完此课后

2
00:00:01,899 --> 00:00:04,089
自己构建玩具应用时节省时间 我们为你提供了

3
00:00:04,089 --> 00:00:06,759
一些起始代码 并使用一些基本代码完成了

4
00:00:06,759 --> 00:00:08,740
大部分 UI 而使用从第一节 Android 课程中

5
00:00:08,740 --> 00:00:10,710
学到的知识 你自己基本就可以

6
00:00:10,710 --> 00:00:12,920
轻松完成这些

7
00:00:12,919 --> 00:00:15,500
那么现在我们来详细看看这些代码

8
00:00:15,500 --> 00:00:18,039
起始代码包含 MainActivity 布局

9
00:00:18,039 --> 00:00:21,189
和 RecyclerView 布局项 提供了用户将

10
00:00:21,190 --> 00:00:24,250
最终在此应用中创建的地点的列表

11
00:00:24,250 --> 00:00:25,870
在 provider 包下

12
00:00:25,870 --> 00:00:28,480
有一堆可以帮助创建数据库的类

13
00:00:28,480 --> 00:00:31,359
以及用于存储用户所选地点的自定义列表

14
00:00:31,359 --> 00:00:33,609
的 content provider

15
00:00:33,609 --> 00:00:35,589
我在这里向起始代码

16
00:00:35,590 --> 00:00:38,830
添加了我们获得的 API 密匙 并将其添加到了

17
00:00:38,829 --> 00:00:41,079
清单文件中

18
00:00:41,079 --> 00:00:44,939
我还在 build.gradle 文件中添加了依赖关系

19
00:00:44,939 --> 00:00:46,479
那么在此课程结束时 我们

20
00:00:46,479 --> 00:00:48,489
要实现的玩具应用的最终目标是

21
00:00:48,490 --> 00:00:52,359
用户能够使用一个叫做 PlacePicker 的库

22
00:00:52,359 --> 00:00:55,060
选择一堆感兴趣的地点

23
00:00:55,060 --> 00:00:58,270
然后这些地点将存储在一个本地数据库中

24
00:00:58,270 --> 00:01:00,826
我们已在起始代码中为你提供了这个数据库

25
00:01:00,826 --> 00:01:02,200
然后应用还应持续监视

26
00:01:02,200 --> 00:01:06,100
设备什么时候进入这些地点 这里使用的

27
00:01:06,099 --> 00:01:09,039
是另一个 Android 功能 叫作地理围栏

28
00:01:09,040 --> 00:01:11,380
它像一个雷达一样检测我们选择的任何地点

29
00:01:11,379 --> 00:01:13,449
然后在发生该等操作时

30
00:01:13,450 --> 00:01:16,390
向用户发送通知

31
00:01:16,390 --> 00:01:18,609
如果用户进入地理围栏 我们将

32
00:01:18,609 --> 00:01:20,903
触发设备进入静音状态

33
00:01:20,903 --> 00:01:22,569
如果用户离开 则触发

34
00:01:22,569 --> 00:01:25,219
设备返回正常状态

35
00:01:25,219 --> 00:01:28,000
在这个练习中 你将构建第一步

36
00:01:28,000 --> 00:01:31,810
将 ShushMe 连接到 Google Play 服务

37
00:01:31,810 --> 00:01:34,600
要这样做 你需要勾选所有这些项

38
00:01:34,599 --> 00:01:36,909
并在你的应用中执行它们

39
00:01:36,909 --> 00:01:38,500
我们已经创建并看过了

40
00:01:38,500 --> 00:01:41,349
如何将 API 键包含在我们的项目中

41
00:01:41,349 --> 00:01:43,899
我们也为所需的两个库

42
00:01:43,900 --> 00:01:45,800
包含了依赖关系

43
00:01:45,799 --> 00:01:48,188
所以完成剩下的两步后

44
00:01:48,188 --> 00:01:50,229
我们就可以在 Google Play 服务中

45
00:01:50,230 --> 00:01:53,374
连接并开始使用所需的库了

46
00:01:53,373 --> 00:01:55,539
那么剩余的两步是授予所需的

47
00:01:55,540 --> 00:01:56,530
权限

48
00:01:56,530 --> 00:02:00,210
然后连接和使用 Google Play 服务

49
00:02:00,209 --> 00:02:01,719
我们从第一个开始

50
00:02:01,719 --> 00:02:04,689
授予应用所需的权限

51
00:02:04,689 --> 00:02:08,379
记住 这个在 Android 清单文件中完成

52
00:02:08,379 --> 00:02:10,240
那么首先 我们需要授予互联网权限

53
00:02:10,240 --> 00:02:13,300
以允许用户搜索和查找

54
00:02:13,300 --> 00:02:15,400
感兴趣的地点

55
00:02:15,400 --> 00:02:17,590
我们还需要授予位置权限

56
00:02:17,590 --> 00:02:20,533
以知道设备的位置

57
00:02:20,533 --> 00:02:22,449
因此 你可以将两种类型的位置权限

58
00:02:22,449 --> 00:02:24,629
添加到清单文件

59
00:02:24,629 --> 00:02:28,900
包括访问粗略位置和访问精确位置

60
00:02:28,900 --> 00:02:30,700
粗略位置允许你仅使用来自蜂窝塔

61
00:02:30,699 --> 00:02:34,089
和 Wi-Fi 的网络供应商信息

62
00:02:34,090 --> 00:02:38,110
访问设备位置

63
00:02:38,110 --> 00:02:40,700
而精确位置权限允许你请求

64
00:02:40,699 --> 00:02:42,579
GPS 卫星位置信息

65
00:02:42,580 --> 00:02:47,080
以获得更具体的位置 因此更为精确

66
00:02:47,080 --> 00:02:49,510
记住 6 以下的 Android 版本 

67
00:02:49,509 --> 00:02:53,069
都要用户在运行时间期间授予一些权限

68
00:02:53,069 --> 00:02:55,900
那么在我们的例子中 对于位置权限

69
00:02:55,900 --> 00:02:58,300
我要在这里添加一个复选框 允许用户

70
00:02:58,300 --> 00:03:00,910
请求该等权限

71
00:03:00,909 --> 00:03:03,500
在此复选框被选中后 它们将调用

72
00:03:03,500 --> 00:03:06,310
ActivityCompact.requestPermissions(),

73
00:03:06,310 --> 00:03:09,159
这时会跳出这个对话框 允许应用

74
00:03:09,159 --> 00:03:11,859
访问设备的位置

75
00:03:11,860 --> 00:03:14,200
那么复选框被点击后 启动

76
00:03:14,199 --> 00:03:16,509
权限请求的代码位于这里的

77
00:03:16,509 --> 00:03:18,729
MainActivity 中

78
00:03:18,729 --> 00:03:21,369
另外 我在这里的 onResume 中 确保

79
00:03:21,370 --> 00:03:24,340
复选框被正确初始化

80
00:03:24,340 --> 00:03:27,430
由于用户永远不用取消选中此复选框

81
00:03:27,430 --> 00:03:29,920
如果设备已授予权限

82
00:03:29,919 --> 00:03:32,079
我将直接禁用此复选框

83
00:03:32,080 --> 00:03:36,219
否则 我将确保其未选中且启用

84
00:03:36,219 --> 00:03:37,389
完美

85
00:03:37,389 --> 00:03:40,329
现在 API 密匙、依赖关系

86
00:03:40,330 --> 00:03:42,130
和权限都已设置妥当

87
00:03:42,129 --> 00:03:43,629
下一步就是创建一个客户端

88
00:03:43,629 --> 00:03:45,639
以开始通过 Google Play 服务

89
00:03:45,639 --> 00:03:47,849
与 API 通信

